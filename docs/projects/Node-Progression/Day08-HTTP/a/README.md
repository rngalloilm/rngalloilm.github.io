# Activity 08.a: SSH Key Access to VM

In this activity, you will configure SSH key-based authentication to access your individual VM. You will generate an SSH key pair, copy the public key to your VM, and test this SSH key-based authentication.

## Activity Resources

1. [SSH Key-Based Authentication](https://www.ssh.com/ssh/key/)

## Task 1: Create SSH Key Pair

In this task you will create a public/private key pair using the `ssh-keygen` command.

### Steps

1. Open a terminal. You can use PowerShell on Windows, Terminal on MacOS, or any terminal emulator on Linux.
2. Run the following command to generate a new SSH key pair. Make sure to use your NCSU email address. 
   ```bash
   ssh-keygen -t ed25519 -C "unityid@ncsu.edu"
   ```
3. You will be prompted to specify a file to save the key. Press `Enter` to accept the default location (`~/.ssh/id_ed25519`).
4. You will be prompted to enter a passphrase. You can press `Enter` to leave it empty, but using a passphrase adds an additional layer of security. If you choose to provide a passphrase, you will be prompted for it every time you connect using the SSH key.
5. Verify that the key pair has been generated by listing the contents of the `.ssh` directory in your home directory:
   ```bash
   ls ~/.ssh
   ```
   You should see at least two files: `id_ed25519` (private key) and `id_ed25519.pub` (public key).

## Task 2: Copy the Public Key to your VM

In this task you will manually deploy your public key to your individual VM.

### Steps

1. Log in to your VM using SSH. Replace `unityId` with your Unity Id and `XXX` with your specific VM number:
   ```bash
   ssh unityId@csc342-XXX-host.csc.ncsu.edu
   ```
2. Enter your Unity password when prompted.
3. Once in your VM, create the `.ssh` directory in your home directory if it does not already exist:
   ```bash
   mkdir -p ~/.ssh
   ```
4. Use the `nano` text editor to create a new file called `authorized_keys` in the `.ssh` directory:
   ```bash
   nano ~/.ssh/authorized_keys
   ```
5. Copy the contents of the **public** key you created in Task 1 (`id_ed25519.pub`) from your local machine and paste it into the `authorized_keys` file on the VM.
6. Save the file and exit the text editor (Ctrl+O, Enter, Ctrl+X).
7. Set the correct permissions on the `.ssh` directory and the `authorized_keys` file:
   ```bash
   chmod 700 ~/.ssh
   chmod 600 ~/.ssh/authorized_keys
   ```

## Task 3: Test SSH Key-Based Authentication

### Steps

1. Log out of your VM:
   ```bash
   exit
   ```
2. Log back in using SSH. If you set a passphrase, you will be prompted to enter it. If everything is configured correctly, you should be able to log in without entering your Unity password. Remember to replace `unityId` with your Unity Id and `XXX` with your specific VM number. 
   ```bash
   ssh unityId@csc342-XXX-host.csc.ncsu.edu
   ```

## Note

Your SSH key pair are credentials that allow anyone who has them to log into the VM as you (using your account). Keep your private key secure and do not share it with anyone. If you suspect that your private key has been compromised, you should generate a new key pair and update the public key on your VM.
